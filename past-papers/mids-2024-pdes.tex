\documentclass[11pt]{penrose}

\input{header}

\title{Past Paper: Partial Differential Equations}
\subtitle{Midterm Exam, 2024}
\begin{document}

\maketitle
\warningtext

\begin{problem}{1}
    Classify the following equation and reduce it to the canonical form
    \begin{equation*}
        u_{xy} + y u_{yy} + \sin(x+y) = 0.
    \end{equation*}

    \solution We start by swapping the variables $x \leftrightarrow y$ to get the transformed PDE
    \begin{equation*}
        x u_{xx} + u_{xy} + \sin(x+y) = 0. \tag{\textasteriskcentered}\label{eq:pde-swap}
    \end{equation*}
    Now, $A = x$, $B = 1$, $C = D = E = 0$. Since, $B^2 - 4AC = 1 > 0$, this is a hyperbolic PDE. So, the corresponding characteristic equation
    \begin{equation*}
        \frac{dy}{dx} = \frac{B \pm \sqrt{B^2 - 4AC}}{2A} = \frac{1 \pm 1}{2x}
    \end{equation*}
    gives
    \begin{equation*}
        \frac{dy}{dx} = \frac{1}{x} \implies k + y = \ln x \implies x e^{-y} = c_1, \quad
        \frac{dy}{dx} = 0 \implies y = c_2.
    \end{equation*}
    Here, $k, c_1$ and $c_2$ are constants. These lead to $\xi = x e^{-y} = c_1$ and $\eta = y = c_2$. As a result
    \begin{align*}
        B^{*} &= 2A\xi_x \eta_x + B \paren*{\xi_x \eta_y + \xi_y \eta_x} + 2C \xi_y \eta_y = e^{-y},\\
        D^{*} &= A \xi_{xx} + B \xi_{xy} + C \xi_{yy} + D \xi_{x} + E \xi_{y} = -e^{-y},\\
        E^{*} &= A \eta_{xx} + B \eta_{xy} + C \eta_{yy} + D \eta_{x} + E \eta_{y} = 0.
    \end{align*}
    (Also, $A^{*} = C^{*} = 0$ because the PDE is hyperbolic.)

    As a result, equation~\eqref{eq:pde-swap} implies
    \begin{equation*}
        e^{-y} u_{\xi\eta} - e^{-y} u_{\xi} = \sin(x + y)
        \implies u_{\xi\eta} - u_{\xi} = e^{\eta}\sin\paren*{\eta + \xi e^\eta}.
    \end{equation*}
    Here, we used $y = \eta$ and $x = \xi e^y = \xi e^\eta$.

    Overall, the canonical form of the given PDE is
    \begin{equation*}
        u_{\xi\eta} = u_{\xi} + e^{\eta}\sin\paren*{\eta + \xi e^\eta}
    \end{equation*}
    with $\xi = y e^{-x}$ and $\eta = x$ (in terms of the original variables).
\end{problem}

\begin{problem}{2}
    Apply a linear transformation $\xi = x+by$ and $\eta = x+dy$ to transform the Euler equation
    \begin{equation*}
        A u_{xx} + 2B u_{xy} + C u_{yy} = 0
    \end{equation*}
    into canonical form, where $b$, $d$ $A$, $B$ and $C$ are constants.

    \solution We note that this is a second order linear PDE with constant coefficients such that $D=E=0$. Under the change of variables $\xi = x+by$ and $\eta = x+dy$, these coefficients transform to
    \begin{align*}
        A^{*} &= A \xi_x^2 + (2B) \xi_x \xi_y + C \xi_y^2 = A + 2Bb + Cb^2,\\
        B^{*} &= 2A\xi_x \eta_x + (2B) \paren*{\xi_x \eta_y + \xi_y \eta_x} + 2C \xi_y \eta_y = 2A + 2B (b+d) + 2C bd,\\
        C^{*} &= A \eta_x^2 + (2B) \eta_x \eta_y + C \eta_y^2 = A + 2Bd + Cd^2,\\
        D^{*} &= A \xi_{xx} + (2B) \xi_{xy} + C \xi_{yy} + D \xi_{x} + E \xi_{y} = 0,\\
        E^{*} &= A \eta_{xx} + (2B) \eta_{xy} + C \eta_{yy} + D \eta_{x} + E \eta_{y} = 0.
    \end{align*}
    The resulting transformed PDE is
    \begin{equation*}
        \paren*{A + 2Bb + Cb^2} u_{\xi\xi} + 2\paren*{A + B (b+d) + C bd} u_{\xi\eta} + \paren*{A + 2Bd + Cd^2} u_{\eta\eta} = 0.
    \end{equation*}

    The canonical form depends on the solutions of $A^* = 0$; i.e. $A + 2Bb + Cb^2 = 0$. This gives
    \begin{equation*}
        A + 2Bb + Cb^2
        \implies
        b = \frac{-B \pm \sqrt{B^2 - AC}}{C}.
    \end{equation*}

    If $B^2 > AC$, then let
    \begin{equation*}
        b = \frac{-B + \sqrt{B^2 - AC}}{C}
        \quad\text{and}\quad
        d = \frac{-B - \sqrt{B^2 - AC}}{C}.
    \end{equation*}
    This eliminates $A^*$ and $C^*$ and reduces the transformed PDE to the hyperbolic canonical form $2\paren*{A + B (b+d) + C bd} u_{\xi\eta} = 0 \implies u_{\xi\eta} = 0$.

    If $B^2 = AC$, then let $b = -B/C$. We note that
    \begin{equation*}
        A + B (b+d) + C bd = A - \frac{B^2}{C} + Bd - Bd = A - A = 0.
    \end{equation*}
    This eliminates $A^*$ and $B^*$ and reduces the transformed PDE to the parabolic canonical form $\paren*{A + 2Bd + Cd^2} u_{\eta\eta} = 0 \implies u_{\eta\eta} = 0$.

    If $B^2 < AC$, then let
    \begin{equation*}
        b = \frac{-B + i\sqrt{AC - B^2}}{C},\quad
        \alpha = \Re \xi = x - \frac{B}{C}, \quad
        \beta = \Im \xi = \frac{\sqrt{AC-B^2}}{C}.
    \end{equation*}
    We find that this leads to $u_{\alpha\alpha} + u_{\beta\beta} = 0$, the elliptic canonical form.
\end{problem}

\begin{problem}{3}
    Determine the solution of the equation
    \begin{equation*}
        x \paren{y^2 + u} u_x - y \paren{x^2 + u} u_y = \paren{x^2 - y^2} u
    \end{equation*}
    with the data $x + y = 0$ and $u = 1$.

    \solution The characteristic equations are
    \begin{equation*}
        \frac{dx}{xy^2 + xu}
        = \frac{dy}{-yx^2 - yu}
        = \frac{du}{(x^2 - y^2)u}
        = \frac{xdx+ydy}{(x^2 - y^2)u}
        = \frac{\frac{dx}{x}+\frac{dy}{y}}{y^2 - x^2}
    \end{equation*}
    Therefore,
    \begin{align*}
        \frac{du}{(x^2 - y^2)u} = \frac{xdx+ydy}{(x^2 - y^2)u}
        &\implies
        du = xdx+ydy\\
        &\implies
        u = \frac{1}{2}x^2 + \frac{1}{2}y^2 + k\\
        &\implies
        2u - x^2 - y^2 = c_1.
    \end{align*}
    And,
    \begin{align*}
        \frac{du}{(x^2 - y^2)u} = \frac{\frac{dx}{x}+\frac{dy}{y}}{y^2 - x^2}
        &\implies
        -\frac{du}{u} = \frac{dx}{x} + \frac{dy}{y}\\
        &\implies
        \log\abs{u} + \log\abs{x} + \log\abs{y} = k\\
        &\implies
        uxy = c_2.
    \end{align*}
    Here, $c_1$, $c_2$ and $k$ are constants. The general solution is $f(2u - x^2 - y^2, uxy) = 0$ where $f$ is an arbitrary function.

    We are given that $x+y = 0$ when $u=1$. This means, $y = -x$ when $u=1$. So,
    \begin{gather*}
        c_2 = uxy = x(-x) = -x^2,\\
        c_1 = 2u - x^2 - y^2 = 2 - x^2 - x^2 = 2 - 2x^2 = 2 + 2c_2.
    \end{gather*}
    Therefore, $c_1 = 2 + 2c_2 \implies 2u - x^2 - y^2 = 2(1 + uxy)$, which can be expressed as
    \begin{equation*}
        u = \frac{2+x^2+y^2}{2-2xy}.
    \end{equation*}
\end{problem}

\begin{problem}{4}
    Show that the general solution of a first-order quasilinear partial differential equation
    \begin{equation*}
        a(x,y,u) u_x + b(x,y,u) u_y = c(x,y,u)
    \end{equation*}
    is $f(\varphi, \psi) = 0$, where $f$ is an arbitrary function of $\varphi(x,y,u)$ and $\psi(x,y,u)$, and $\varphi(x,y,u) = c_1$ and $\psi(x,y,u) = c_2$ are solution curves of the characteristic equations
    \begin{equation*}
        \frac{dx}{a} = \frac{dy}{b} = \frac{du}{c}.
    \end{equation*}

    \solution By equating the ratios in the characteristic equations to a common parameter
    \begin{equation*}
        \frac{dx}{a(x,y,u)} = \frac{dy}{b(x,y,u)} = \frac{du}{c(x,y,u)} = dt
    \end{equation*}
    we can write $dx = a dt$, $dy = b dt$ and $du = c dt$. Now,
    \begin{gather*}
        \phi(x,y,u) = c_1
        \implies
        d\phi = \phi_x dx + \phi_y dy + \phi_u du = 0
        \implies
        a \phi_x + b \phi_y + c \phi_u = 0,\\
        \psi(x,y,u) = c_2
        \implies
        d\psi = \psi_x dx + \psi_y dy + \psi_u du = 0
        \implies
        a \psi_x + b \psi_y + c \psi_u = 0.
    \end{gather*}

    Simultaneously solving these two equations (for $a, b, c$) gives
    \begin{equation*}
        \frac{a}{\begin{vmatrix} \phi_y & \phi_u \\ \psi_y & \psi_u \end{vmatrix}}
        = \frac{-b}{\begin{vmatrix} \phi_x & \phi_u \\ \psi_x & \psi_u \end{vmatrix}}
        = \frac{c}{\begin{vmatrix} \phi_x & \phi_y \\ \psi_x & \psi_y \end{vmatrix}}
        = \lambda.
    \end{equation*}
    By defining the notation $\frac{\pd(\phi,\psi)}{\pd(x,y)} = \begin{vsmallmatrix*} \phi_x & \phi_y \\ \psi_x & \psi_y \end{vsmallmatrix*}$ these ratios can be rewritten as
    \begin{equation*}
        \frac{a}{\displaystyle\frac{\pd(\phi,\psi)}{\pd(y,u)}}
        = \frac{b}{\displaystyle\frac{\pd(\phi,\psi)}{\pd(u,x)}}
        = \frac{c}{\displaystyle\frac{\pd(\phi,\psi)}{\pd(x,y)}}
        = \lambda.
    \end{equation*}
    Here we used $-\begin{vsmallmatrix*} \phi_u & \phi_x \\ \psi_u & \psi_x \end{vsmallmatrix*} = \begin{vsmallmatrix*} \phi_x & \phi_u \\ \psi_x & \psi_u \end{vsmallmatrix*}$. Consequently,
    \begin{equation*}
        \frac{\pd(\phi, \psi)}{\pd(y,u)} = \frac{a}{\lambda}, \quad
        \frac{\pd(\phi, \psi)}{\pd(u,x)} = \frac{b}{\lambda}, \quad
        \frac{\pd(\phi, \psi)}{\pd(x,y)} = \frac{c}{\lambda}.
    \end{equation*}

    Using the expressions found above, we get
    \begin{equation*}
        a u_x + b u_y = c
        \iff
        u_x \frac{\pd(\phi, \psi)}{\pd(y,u)}
        + u_y \frac{\pd(\phi, \psi)}{\pd(u,x)}
        = \frac{\pd(\phi, \psi)}{\pd(x,y)}.
    \end{equation*}

    Now, since $f(\phi, \psi) = 0$ satisfies the PDE
    \begin{equation*}
        u_x \frac{\pd(\phi, \psi)}{\pd(y,u)}
        + u_y \frac{\pd(\phi, \psi)}{\pd(u,x)}
        = \frac{\pd(\phi, \psi)}{\pd(x,y)},
    \end{equation*}
    we conclude that $f(\phi,\psi) = 0$ satisfies the PDE $au_x + bu_y = c$.
\end{problem}

\begin{problem}{5}
    Verify that the function
    \begin{equation*}
        u = \varphi(xy) + x \psi\paren*{\frac{y}{x}}
    \end{equation*}
    is the general solution of the equation
    \begin{equation*}
        x^2 u_{xx} - y^2 u_{yy} = 0.
    \end{equation*}

    \solution We have
    \begin{align*}
        u_{x} &= y \varphi'(xy) + \psi\paren*{\frac{y}{x}} - x \paren*{\frac{y}{x^2}} \psi'\paren*{\frac{y}{x}} = y \varphi'(xy) + \psi\paren*{\frac{y}{x}} - \frac{y}{x} \psi'\paren*{\frac{y}{x}}\\
        u_{y} &= x \varphi'(xy) + x \paren*{\frac{1}{x}} \psi'\paren*{\frac{y}{x}} = x \varphi'(xy) + \psi'\paren*{\frac{y}{x}}\\
        u_{xx} &= y^2 \varphi''(xy) - \frac{y}{x^2} \psi'\paren*{\frac{y}{x}} + \frac{y}{x^2} \psi'\paren*{\frac{y}{x}} + \frac{y^2}{x^3} \psi''\paren*{\frac{y}{x}}
        = y^2 \varphi''(xy) + \frac{y^2}{x^3} \psi''\paren*{\frac{y}{x}}\\
        u_{yy} &= x^2 \varphi''(xy) + \frac{1}{x} \psi''\paren*{\frac{y}{x}}
    \end{align*}
    Therefore,
    \begin{equation*}
        x^2 u_{xx} - y^2 u_{yy} = x^2 y^2 \varphi''(xy) + \frac{y^2}{x} \psi''\paren*{\frac{y}{x}} - x^2 y^2 \varphi''(xy) + \frac{y^2}{x} \psi''\paren*{\frac{y}{x}} = 0
    \end{equation*}
\end{problem}

\clearpage
\begin{problem}{6}
    Determine the solution of the initial boundary value problem
    \begin{equation*}
        \begin{aligned}
            u_{tt} &= 4u_{xx}, & &0 < x < 1, \quad t > 0,\\
            u(x,0) &= 0, & &0 \leq x \leq 1,\\
            u_t(x,0) &= x(1-x), & &0 \leq x \leq 1,\\
            u(0,t) &= 0, \; u(1,t) = 0, & \quad &t \geq 0.
        \end{aligned}
    \end{equation*}
    
    \solution This is the wave equation ($c = 2$) on a bounded spatial interval $[0,1]$. The general solution is $u(x, t) = \varphi(x + 2t) + \psi(x - 2t)$ with
    \begin{equation*}
        \varphi(\eta) = \frac{1}{2} f(\eta) + \frac{1}{2c} \int_0^\eta g(\tau) \,d\tau + \frac{K}{2},
        \quad
        \psi(\eta) = \frac{1}{2} f(\eta) - \frac{1}{2c} \int_0^\eta g(\tau) \,d\tau - \frac{K}{2}.
    \end{equation*}
    for $0 \leq \eta \leq 1$. Using $f(\eta) = 0$ and $g(\eta) = \eta (1 - \eta)$ gives,
    \begin{gather}
        \varphi(\eta) = \frac{1}{4} \paren*{\frac{1}{2}\eta^2 - \frac{1}{3}\eta^3} + \frac{K}{2}, \quad 0 \leq \eta \leq 1, \label{eq:1-phi}\\
        \psi(\eta) = - \frac{1}{4} \paren*{\frac{1}{2}\eta^2 - \frac{1}{3}\eta^3} - \frac{K}{2}, \quad 0 \leq \eta \leq 1. \label{eq:1-psi}
    \end{gather}

    The boundary conditions give
    \begin{gather*}
        u(0,t) = 0 \implies \psi(-2t) = -\varphi(2t) \implies \psi(\eta) = -\varphi(-\eta), \tag{\textasteriskcentered} \label{eq:bc-1}\\
        u(1,t) = 0 \implies \varphi(1+2t) = -\psi(1-2t) \implies \varphi(\eta) = -\psi(2-\eta). \tag{\textasteriskcentered\textasteriskcentered} \label{eq:bc-2}
    \end{gather*}

    Now, using \eqref{eq:bc-1} in \eqref{eq:1-phi} gives,
    \begin{equation}
        \psi(\eta)
        = -\varphi(-\eta)
        = -\frac{1}{4} \paren*{\frac{1}{2}\eta^2 + \frac{1}{3}\eta^3} - \frac{K}{2}. \label{eq:2-psi}
    \end{equation}
    This is valid for $0 \leq -\eta \leq 1 \implies -1 \leq \eta \leq 0$. So, the domain of $\psi$ has been extended.

    Similarly, using \eqref{eq:bc-2} in \eqref{eq:1-psi} gives,
    \begin{equation}
        \varphi(\eta)
        = -\psi(2-\eta)
        = \frac{1}{4} \paren*{\frac{1}{2}(2-\eta)^2 - \frac{1}{3}(2-\eta)^3} + \frac{K}{2}. \label{eq:2-phi}
    \end{equation}
    This is valid for $0 \leq 2-\eta \leq 1 \implies 1 \leq \eta \leq 2$. So, the domain of $\varphi$ has been extended.

    We repeat this process to extend the domain further: using \eqref{eq:bc-1} in \eqref{eq:2-psi} and \eqref{eq:bc-2} in \eqref{eq:2-phi}.
\end{problem}

\end{document}